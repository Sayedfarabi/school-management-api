generator client {
  provider     = "prisma-client"
  output       = "../generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            String   @id @default(uuid())
  name          String
  email         String   @unique
  phone         String
  password_hash String
  role          UserRole @default(Student)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  student       Student?

  @@index([email])
  @@map("users")
}

model Class {
  id      String @id @default(uuid())
  name    String
  section String

  students Student[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([name, section])
  @@map("classes")
}

model Student {
  id   String @id @default(uuid())
  name String
  age  Int

  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  classId String?
  class   Class?  @relation(fields: [classId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([classId])
  @@map("students")
}

enum UserRole {
  Admin
  Teacher
  Student
}

enum ClassSection {
  Morning
  Evening
}
